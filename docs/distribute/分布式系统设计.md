---
title: 分布式系统设计
sidebar_position: 2
---


1. 模块划分
2. 模块职责清晰
3. 模块内聚性足够高
4. 模块职责单一






分布式系统一般存在三种模式：
- 副本模式： 以多副本，设置主从来实现读写分离，提高QPS。
- 分区模式： 以核心处理逻辑（多为数据）进行分区，将一个或多个分区调度到一个节点上，来扩展服务的读写能力。
- 副本 + 分区： 分区实现读写性能，副本实现服务的可靠性。


分布式中存在多个节点，也就意味着需要对请求进行路由，所以消息总线也是分布式绕不过去的。



为了达到负载更加均衡，我们需要：
1. 请求负载均衡，请求负载均衡就会带来路由
    a. 路由如何实现？
    b. 路由由谁来实现？

2. 请求除了节点间的负载均衡之外，请求的主体被分配到节点之后，我们还需要考虑请求的流量削峰，这时会引入两个问题：
    a. 如何实现削峰？
    b. 一般我们使用 MQ 来实现削峰，这时会引入多个问题：
        - 引入MQ也就意味着异步请求，异步请求如何实现同步调用？
            - 这个我们一本使用回调来实现同步调用。
        - 引入MQ之后，我们如何去保证可靠消费？
            - 水位线
            - checkpoint
    c. 








